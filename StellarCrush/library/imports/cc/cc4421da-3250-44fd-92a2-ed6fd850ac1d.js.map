{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\Script\\Model/assets\\Script\\Model\\GameModel.js"],"names":["GameModel","cells","cellBgs","lastPos","cc","v2","cellTypeNum","cellCreateType","score","death_sign","data","prototype","init","setCellTypeNum","i","GRID_WIDTH","j","GRID_HEIGHT","CellModel","flag","getRandomCellType","result","checkPoint","length","setXY","setStartXY","reInitWithData","indexArr","k","console","log","pos1","index1","Math","floor","random","index2","pos2","exchangeCell","tmp","type","gainScore","sum","x","y","checkWithDirection","direction","queue","vis","push","front","point","cellModel","tmpX","tmpY","rowResult","call","colResult","newCellStatus","CELL_STATUS","WRAP","concat","forEach","newEle","oldEle","printInfo","printStr","getCells","selectCell","pos","changeModels","effectsQueue","delta","abs","curClickCell","lastClickCell","result1","result2","curTime","pushToChangeModels","isCanBomb","status","COMMON","BIRD","moveToAndBack","moveTo","ANITIME","TOUCH_MOVE","processCrush","cycleCount","bombModels","model1","model2","crushCell","LINE","COLUMN","curType","posY1","newCellType","model","createNewCell","processBomb","DIE","down","CELL_TYPE","setStatus","setVisible","newCheckPoint","curRow","count","indexOf","cleanCmd","cmd","tmpModel","num","randomNum","CELL_BASENUM","index","newBombModel","bombTime","BOMB_DELAY","addRowBomb","addColBomb","crushType","BOMB_BIRD_DELAY","addCrushEffect","playTime","step","action","addWrapBomb","needShake","toShake","toDie","DIE_SHAKE","findSelectCell","res","ii"],"mappings":"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","file":"GameModel.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\Model","sourcesContent":["import CellModel from \"./CellModel\";\nimport { CELL_TYPE, CELL_BASENUM, CELL_STATUS, GRID_WIDTH, GRID_HEIGHT, ANITIME } from \"./ConstValue\";\n\nexport default function GameModel(){\n    this.cells = null;\n    this.cellBgs = null;\n    this.lastPos = cc.v2(-1, -1);\n    this.cellTypeNum = 5;\n    this.cellCreateType = []; \n    this.score = 0;  \n    this.death_sign = false; \n    this.data = [] \n}\n\nGameModel.prototype.init = function(cellTypeNum){\n    this.cells = [];\n    this.setCellTypeNum(cellTypeNum || this.cellTypeNum);\n    for(var i = 1;i<=GRID_WIDTH;i++){\n        this.cells[i] = [];                \n        for(var j = 1;j <= GRID_HEIGHT;j++){\n            this.cells[i][j] = new CellModel();\n        }\n    }\n  \n    for(var i = 1;i<=GRID_WIDTH;i++){\n        for(var j = 1;j <= GRID_HEIGHT;j++){\n            let flag = true;\n            while(flag){\n                flag = false;\n                this.cells[i][j].init(this.getRandomCellType());\n               \n                let result = this.checkPoint(j, i)[0];\n                if(result.length > 2){\n                    flag = true;\n                }\n                this.cells[i][j].setXY(j, i);\n                this.cells[i][j].setStartXY(j, i);\n            }\n        }\n    }\n}\n\n\nGameModel.prototype.reInitWithData = function(){\n    // this.printInfo();\n    let indexArr = [];\n    for (let k = 0;k< GRID_HEIGHT* GRID_WIDTH;k++){\n        indexArr[k] = false;\n    }\n    console.log(indexArr);\n    for(var i = 5;i<=GRID_WIDTH;i++){             \n        for(var j = 5;j <= GRID_HEIGHT;j++){\n            let pos1 = cc.v2(i,j);\n            let index1 = Math.floor(Math.random() * (1 + GRID_WIDTH - 1) + 1);\n            let index2 = Math.floor(Math.random() * (1 + GRID_HEIGHT - 1) + 1);\n            let pos2 = cc.v2(index1,index2);\n            // console.log(indexArr[i*GRID_WIDTH+ j] +\" okokokokoko\"+indexArr[index1*GRID_WIDTH + index2]);\n            if(!indexArr[i*GRID_WIDTH+ j-1] && !indexArr[index1*GRID_WIDTH + index2-1] &&(i!=index1) && (j!=index2)){\n                this.exchangeCell(pos1,pos2);\n                let tmp =  this.cells[i][j].type;\n                this.cells[index1][index2].type = tmp;\n                this.cells[i][j].type = this.cells[index1][index2].type;\n                indexArr[i*GRID_WIDTH+ j-1] = true;\n            indexArr[index1*GRID_WIDTH + index2-1] = true;\n            }else{\n                break;\n            }\n            \n        }\n    }\n    return this.cells;\n} \n\n//gainScore\nGameModel.prototype.gainScore = function(){\n    var sum = 0;\n    this.score += 0;\n    sum += this.score;\n    // console.log(\"SCORE:::\" + this.score + \"sum:\" + sum);\n    return sum;\n}\n\nGameModel.prototype.checkPoint = function (x, y) {\n\n    let checkWithDirection = function (x, y, direction) {\n        let queue = [];\n        let vis = [];\n        vis[x + y * GRID_HEIGHT] = true;\n        queue.push(cc.v2(x, y));\n        let front = 0;\n        while (front < queue.length) {\n            let point = queue[front];\n            let cellModel = this.cells[point.y][point.x];\n            front++;\n            if (!cellModel) {\n                continue;\n            }\n\n            for (let i = 0; i < direction.length; i++) {\n                let tmpX = point.x + direction[i].x;\n                let tmpY = point.y + direction[i].y;\n\n                if (tmpX < 1 || tmpX > GRID_WIDTH\n                    || tmpY < 1 || tmpY > GRID_HEIGHT\n                    || vis[tmpX + tmpY * GRID_HEIGHT]\n                    || !this.cells[tmpY][tmpX]) {\n                    continue;\n                }\n                if (cellModel.type == this.cells[tmpY][tmpX].type) {\n                    vis[tmpX + tmpY * GRID_HEIGHT] = true;\n                    queue.push(cc.v2(tmpX, tmpY));\n                }\n            }\n        }\n        return queue;\n    }\n    let rowResult = checkWithDirection.call(this,x,y,[cc.v2(1, 0), cc.v2(-1, 0)]);\n    let colResult = checkWithDirection.call(this,x,y,[cc.v2(0, -1), cc.v2(0, 1)]);\n    let result = [];\n    let newCellStatus = \"\";\n    //เงื่อนไข\n    if(rowResult.length >= 5 || colResult.length >= 5){\n        //newCellStatus = CELL_STATUS.BIRD;\n    }\n    else if(rowResult.length >= 3 && colResult.length >= 3){\n        newCellStatus = CELL_STATUS.WRAP;\n    }\n    else if(rowResult.length >= 4){\n        //newCellStatus = CELL_STATUS.LINE;\n        \n    }\n    else if(colResult.length >= 4){\n        //newCellStatus = CELL_STATUS.COLUMN;\n    }\n   if(rowResult.length >= 3){\n        result = rowResult;\n    }\n    \n    if(colResult.length >= 3){\n        let tmp = result.concat();\n        colResult.forEach(function(newEle){\n            let flag = false;\n            tmp.forEach(function (oldEle) {\n                if(newEle.x == oldEle.x && newEle.y == oldEle.y){\n                    flag = true;\n                }\n            }, this);\n            if(!flag){\n                result.push(newEle);\n            }\n        }, this);\n    }\n    return [result,newCellStatus, this.cells[y][x].type];\n}\n\n//Create cell\nGameModel.prototype.printInfo = function(){\n    for(var i = 1; i<=8 ;i++){\n        var printStr = \"\";\n        for(var j = 1; j<=8;j++){\n            printStr += this.cells[i][j].type + \" \";\n        }\n        console.log(printStr+ \"this is celles info\");\n    }\n}\n\nGameModel.prototype.getCells = function(){\n    return this.cells;\n}\n\n//------------>>>>>>>>START controller>>>>>>>>>>>>>>>>>>------------\n//01คลิกที่ตาราง\nGameModel.prototype.selectCell =function(pos){\n    this.changeModels = [];//change model retrun view\n    this.effectsQueue = []; \n   \n    var lastPos = this.lastPos;\n    console.log(\"current cell position \"+ pos + \" Last cell position \"+ lastPos);\n    var delta = Math.abs(pos.x - lastPos.x) + Math.abs(pos.y - lastPos.y);\n    if(delta != 1){ \n        this.lastPos = pos;\n        return [[], []];\n    }\n \n    let curClickCell = this.cells[pos.y][pos.x]; \n    let lastClickCell = this.cells[lastPos.y][lastPos.x]; \n    this.exchangeCell(lastPos, pos); \n    var result1 = this.checkPoint(pos.x, pos.y)[0];\n    var result2 = this.checkPoint(lastPos.x, lastPos.y)[0];\n    this.curTime = 0; \n    this.pushToChangeModels(curClickCell);\n    this.pushToChangeModels(lastClickCell);\n    let isCanBomb = (curClickCell.status != CELL_STATUS.COMMON && lastClickCell.status != CELL_STATUS.COMMON)\n           || curClickCell.status == CELL_STATUS.BIRD ||\n             lastClickCell.status == CELL_STATUS.BIRD; \n    if(result1.length < 3 && result2.length < 3 && !isCanBomb){\n        this.exchangeCell(lastPos, pos);\n        curClickCell.moveToAndBack(lastPos);\n        lastClickCell.moveToAndBack(pos);\n        this.lastPos = cc.v2(-1, -1);\n        return [this.changeModels];\n    }\n    else{\n        this.lastPos = cc.v2(-1,-1);\n        curClickCell.moveTo(lastPos, this.curTime);\n        lastClickCell.moveTo(pos, this.curTime);\n        var checkPoint = [pos, lastPos];\n        this.curTime += ANITIME.TOUCH_MOVE;\n        this.processCrush(checkPoint);\n        this.score += 30;\n        return [this.changeModels, this.effectsQueue];\n    }\n}\n\nGameModel.prototype.processCrush = function(checkPoint){\n    let cycleCount = 0;\n     while(checkPoint.length > 0){\n        let bombModels = [];\n        if(cycleCount == 0 && checkPoint.length == 2){ \n            let pos1= checkPoint[0];\n            let pos2 = checkPoint[1];\n            let model1 = this.cells[pos1.y][pos1.x];\n            let model2 = this.cells[pos2.y][pos2.x];\n\n            if(model1.status == CELL_STATUS.BIRD && model2.status ==  CELL_STATUS.BIRD){\n                for(let i = 1;i <= GRID_WIDTH; i++){\n                    for(let j = 1;j <= GRID_HEIGHT; j++){\n                        if(this.cells[i][j] && this.cells[i][j].status != CELL_STATUS.COMMON){\n                            console.log(\"Here you need to change the special effect of each animal after a delay of 0.3s before eliminating it.\");\n                            // this.pushToChangeModels(this.cells[i][j]);\n                            bombModels.push(this.cells[i][j]);\n                        }\n                    }\n                }\n\n                for(let i = 1;i <= GRID_HEIGHT; i++){\n                    for(let j = 1;j <= GRID_WIDTH; j++){\n                        this.crushCell(j, i, false, cycleCount);\n                        }\n                }\n            }\n            \n\n            //Boom\n            if((model1.status == CELL_STATUS.BIRD && model2.status == CELL_STATUS.LINE)  \n            || (model1.status == CELL_STATUS.BIRD && model2.status == CELL_STATUS.COLUMN )            \n            || (model1.status == CELL_STATUS.BIRD && model2.status == CELL_STATUS.WRAP )    \n            ){\n                let curType = model2.type;\n                console.log(\"LINE COLUMN WRAP，\" + curType);\n                for(let i = 1;i <= GRID_HEIGHT; i++){\n                    for(let j = 1;j <= GRID_WIDTH; j++){\n                        if(this.cells[i][j] && this.cells[i][j].type == curType){\n                            this.cells[i][j].status = model2.status;\n                            console.log(\"Here you need to change the special effect of each animal after a delay of 0.3s before eliminating it.\");\n                            // this.pushToChangeModels(this.cells[i][j]);\n                            bombModels.push(this.cells[i][j]);\n                            this.changeModels.push(this.cells[i][j]);\n                        }\n                    }\n                }\n            }\n            if ((model1.status == CELL_STATUS.LINE && model2.status == CELL_STATUS.BIRD )\n            || (model1.status == CELL_STATUS.COLUMN && model2.status == CELL_STATUS.BIRD )\n            || (model1.status == CELL_STATUS.WRAP && model2.status == CELL_STATUS.BIRD )\n            ){\n                let curType = model1.type;\n                console.log(\"LINE COLUMN WRAP，\" + curType);\n                for(let i = 1;i <= GRID_HEIGHT; i++){\n                    for(let j = 1;j <= GRID_WIDTH; j++){\n                        if(this.cells[i][j] && this.cells[i][j].type == curType){\n                            this.cells[i][j].status = model1.status;\n                            console.log(\"Here you need to change the special effect of each animal after a delay of 0.3s before eliminating it.\");\n                            // this.pushToChangeModels(this.cells[i][j]);\n                            bombModels.push(this.cells[i][j]);\n                            this.changeModels.push(this.cells[i][j]);\n                        }\n                    }\n                }\n            }\n             \n\n            if ((model1.status == CELL_STATUS.BIRD && model2.status == CELL_STATUS.COMMON) \n            ){\n                model1.type = model2.type;\n                bombModels.push(model1);\n            }\n            if ((model1.status == CELL_STATUS.COMMON && model2.status == CELL_STATUS.BIRD )\n            ){\n                model2.type = model1.type;\n                bombModels.push(model2);\n            }\n\n            //LINE COLUMN WRAP\n            if((model1.status == CELL_STATUS.LINE && model2.status == CELL_STATUS.LINE) \n            || (model1.status == CELL_STATUS.COLUMN && model2.status == CELL_STATUS.COLUMN )\n            || (model1.status == CELL_STATUS.LINE && model2.status == CELL_STATUS.COLUMN )\n            || (model1.status == CELL_STATUS.COLUMN && model2.status == CELL_STATUS.LINE )\n            // || (model1.status == CELL_STATUS.WRAP && model2.status == CELL_STATUS.WRAP )\n            \n            ){\n                bombModels.push(model1);\n                bombModels.push(model2);\n            }\n            \n            // 5 WRAP  WRAP \n            if((model1.status == CELL_STATUS.WRAP && model2.status == CELL_STATUS.WRAP )){\n                // if(model1.x == model2.x){\n                //     let flag = pos1.x < pos2.x ? 1 : -1;\n                //     let plus = (-1) * flag;\n                //     let model1 = (this.cells[pos1.y][pos1.x + plus]) ? this.cells[pos1.y][pos1.x + plus]: model1;\n                //     let model2 = (this.cells[pos2.y][pos2.x - plus]) ? this.cells[pos2.y][pos2.x - plus]: model2;\n                //     console.log(model1.x +\" (1111) \" + model1.y  + \"$$$$$$$$\" + model2.x + \" (22222) \" + model2.y);\n                //     bombModels.push(model1);\n                //     bombModels.push(model2);\n                // }else{\n                //     let flag = pos1.y < pos2.y ? 1 : -1;\n                //     let plus = (-1) * flag;\n                //     let model1 = (this.cells[pos1.y + plus][pos1.x]) ? this.cells[pos1.y + plus][pos1.x]: model1;\n                //     let model2 = (this.cells[pos2.y - plus][pos2.x]) ? this.cells[pos2.y - plus][pos2.x]: model2;\n                //     console.log(model1.x +\" (1111) \" + model1.y  + \"$$$$$$$$\" + model2.x + \" (22222) \" + model2.y);\n                //     bombModels.push(model1);\n                //     bombModels.push(model2);\n                // }\n                bombModels.push(model1);\n                bombModels.push(model2);\n            }            \n            // 6 LINE WRAP \n            if((model1.status == CELL_STATUS.LINE && model2.status == CELL_STATUS.WRAP )\n            || (model1.status == CELL_STATUS.WRAP && model2.status == CELL_STATUS.LINE )\n            ){\n                if(model1.status == CELL_STATUS.LINE){\n                   \n                    let posY1 = model1.y;\n                    for(let i = 1;i <= GRID_WIDTH; i++){\n                        for(let j = 1;j <= GRID_HEIGHT; j++){\n                            if( (i >= posY1 -1) && (i <= posY1+1) && this.cells[i][j]){\n                                this.crushCell(j, i, false, cycleCount);\n                            }    \n                        }\n                    }\n\n                }else{\n                    let posY1 = model2.y;\n                    for(let i = 1;i <= GRID_WIDTH; i++){\n                        for(let j = 1;j <= GRID_HEIGHT; j++){\n                            if( (i >= posY1-1) && (i <= posY1+1) && this.cells[i][j]){\n                                this.crushCell(j, i, false, cycleCount);\n                            }  \n                        }\n                    }  \n                }\n            }\n            \n            // 7 WRAP  COLUMN \n            if((model1.status == CELL_STATUS.WRAP && model2.status == CELL_STATUS.COLUMN )\n            || (model1.status == CELL_STATUS.COLUMN && model2.status == CELL_STATUS.WRAP )\n            ){\n                if(model1.status == CELL_STATUS.COLUMN){\n                    let posY1 = model1.x;\n                    for(let i = 1;i <= GRID_WIDTH; i++){\n                        for(let j = 1;j <= GRID_HEIGHT; j++){\n                            if( (j >= posY1-1) && (j <= posY1+1) && this.cells[i][j]){\n                                this.crushCell(j, i, false, cycleCount);\n                            }    \n                        }\n                    }\n\n                }else{\n                    let posY1 = model2.x;\n                    for(let i = 1;i <= GRID_WIDTH; i++){\n                        for(let j = 1;j <= GRID_HEIGHT; j++){\n                            if( (j >= posY1-1) && (j <= posY1+1) && this.cells[i][j]){\n                                this.crushCell(j, i, false, cycleCount);\n                            }    \n                        }\n                    }\n                }\n                \n            }\n        \n\n        }\n        for(var i in checkPoint){\n            var pos = checkPoint[i];\n            if(!this.cells[pos.y][pos.x]){\n                continue;\n            }\n            // tmp checkpoint [result,newCellStatus, this.cells[y][x].type];\n            var tmp = this.checkPoint(pos.x, pos.y);\n            var result = tmp[0];\n            var newCellStatus = tmp[1];\n            var newCellType = tmp[2];\n            \n            if(result.length < 3){\n                continue;\n            }\n            for(var j in result){\n                var model = this.cells[result[j].y][result[j].x];\n                this.crushCell(result[j].x, result[j].y, false, cycleCount); //cell  cycleCount ,cell\n                if(model.status != CELL_STATUS.COMMON){\n                    bombModels.push(model);\n                }\n            }\n\n            this.createNewCell(pos, newCellStatus, newCellType);   \n\n        }\n        this.processBomb(bombModels, cycleCount);\n        this.curTime += ANITIME.DIE;\n        checkPoint = this.down();\n        cycleCount++;\n    }\n    \n}\n\n\nGameModel.prototype.createNewCell = function(pos,status,type){\n    if(status == \"\"){\n        return ;\n    }\n    if(status == CELL_STATUS.BIRD){\n        type = CELL_TYPE.BIRD\n    }\n    let model = new CellModel();\n    this.cells[pos.y][pos.x] = model\n    model.init(type);\n    model.setStartXY(pos.x, pos.y);\n    model.setXY(pos.x, pos.y);\n    model.setStatus(status);\n    model.setVisible(0, false);\n    model.setVisible(this.curTime, true);\n    this.changeModels.push(model);\n}\n\nGameModel.prototype.down = function(){\n    let newCheckPoint = [];\n     for(var i = 1;i<=GRID_WIDTH;i++){\n        for(var j = 1;j <= GRID_HEIGHT;j++){\n            if(this.cells[i][j] == null){\n                var curRow = i;\n                for(var k = curRow; k<=GRID_HEIGHT;k++){\n                    if(this.cells[k][j]){\n                        this.pushToChangeModels(this.cells[k][j]);\n                        newCheckPoint.push(this.cells[k][j]);\n                        this.cells[curRow][j] = this.cells[k][j];\n                        this.cells[k][j] = null;\n                        this.cells[curRow][j].setXY(j, curRow);\n                        this.cells[curRow][j].moveTo(cc.v2(j, curRow), this.curTime);\n                        curRow++; \n                    }\n                }\n                var count = 1;\n                for(var k = curRow; k<=GRID_HEIGHT; k++){\n                    this.cells[k][j] = new CellModel();\n                    this.cells[k][j].init(this.getRandomCellType());\n                    this.cells[k][j].setStartXY(j, count + GRID_HEIGHT);\n                    this.cells[k][j].setXY(j, count + GRID_HEIGHT);\n                    this.cells[k][j].moveTo(cc.v2(j, k), this.curTime);\n                    count++;\n                    this.changeModels.push(this.cells[k][j]);\n                    newCheckPoint.push(this.cells[k][j]);\n                }\n\n            }\n        }\n    }\n    this.curTime += ANITIME.TOUCH_MOVE + 0.3\n    return newCheckPoint;\n}\n\nGameModel.prototype.pushToChangeModels = function(model){\n    if(this.changeModels.indexOf(model) != -1){\n        return ;\n    }\n    this.changeModels.push(model);\n}\n\nGameModel.prototype.cleanCmd = function(){\n    for(var i = 1;i<=GRID_WIDTH;i++){\n        for(var j = 1;j <= GRID_HEIGHT;j++){\n            if(this.cells[i][j]){\n                this.cells[i][j].cmd = [];\n            }\n        }\n    }\n}\n\n\nGameModel.prototype.exchangeCell = function(pos1, pos2){\n    var tmpModel = this.cells[pos1.y][pos1.x];\n    this.cells[pos1.y][pos1.x] = this.cells[pos2.y][pos2.x];\n    this.cells[pos1.y][pos1.x].x = pos1.x;\n    this.cells[pos1.y][pos1.x].y = pos1.y;\n    this.cells[pos2.y][pos2.x] = tmpModel;\n    this.cells[pos2.y][pos2.x].x = pos2.x;\n    this.cells[pos2.y][pos2.x].y = pos2.y;\n}\n// \n// Todo \nGameModel.prototype.setCellTypeNum = function(num){\n    this.cellTypeNum = num;\n    this.cellCreateType = [];\n    for(var i = 1; i<= num;i++){\n        while(true){\n            var randomNum = Math.floor(Math.random() * CELL_BASENUM) + 1;\n            if(this.cellCreateType.indexOf(randomNum) == -1){\n                this.cellCreateType.push(randomNum);\n                break;\n            }\n        }\n    }\n}\n\nGameModel.prototype.getRandomCellType = function(){\n    var index = Math.floor(Math.random() * this.cellTypeNum);\n    console.log(this.cellCreateType[index]+ \" this.cellCreateType[index]\");\n    return this.cellCreateType[index];\n}\n\n// 04 bombModels\nGameModel.prototype.processBomb = function(bombModels, cycleCount){\n    while(bombModels.length > 0){\n        let newBombModel = [];\n        let bombTime = ANITIME.BOMB_DELAY;\n        \n        bombModels.forEach(function(model){\n            if(model.status == CELL_STATUS.LINE){\n                for(let i = 1; i<= GRID_WIDTH; i++){\n                    if(this.cells[model.y][i]){\n                        if(this.cells[model.y][i].status != CELL_STATUS.COMMON){\n                            newBombModel.push(this.cells[model.y][i]); //newBombModel\n                        }\n                        this.crushCell(i, model.y, false, cycleCount); // crushcell\n                    }\n                }\n                this.score += 200;\n                this.addRowBomb(this.curTime, cc.v2(model.x, model.y));\n            }\n            else if(model.status == CELL_STATUS.COLUMN){\n                for (let i = 1; i <= GRID_HEIGHT; i++) {\n                    if (this.cells[i][model.x]) {\n                        if (this.cells[i][model.x].status != CELL_STATUS.COMMON) {\n                            newBombModel.push(this.cells[i][model.x]);\n                        }\n                        this.crushCell(model.x, i, false, cycleCount);\n                    }\n                }\n                this.score += 200;\n                this.addColBomb(this.curTime, cc.v2(model.x, model.y));\n            }\n            else if(model.status == CELL_STATUS.WRAP){\n                let x = model.x;\n                let y = model.y;\n                this.score += 500;\n                for(let i = 1;i <= GRID_WIDTH; i++){\n                    for(let j = 1;j <= GRID_HEIGHT; j++){\n                        let delta = Math.abs(x - j) + Math.abs(y - i);\n                        if(this.cells[i][j] && delta <= 2){\n                            if (this.cells[i][j].status != CELL_STATUS.COMMON) {\n                                newBombModel.push(this.cells[i][j]);\n                            }\n                            this.crushCell(j, i, false, cycleCount);\n                        }\n                    }\n                }\n            }\n            else if(model.status == CELL_STATUS.BIRD){\n                let crushType = model.type\n                if(bombTime < ANITIME.BOMB_BIRD_DELAY){\n                    bombTime = ANITIME.BOMB_BIRD_DELAY;\n                }\n                if(crushType == CELL_TYPE.BIRD){\n                    crushType = this.getRandomCellType(); \n                }\n                for(let i = 1;i <= GRID_WIDTH; i++){\n                    for(let j = 1;j <= GRID_HEIGHT; j++){\n                        if(this.cells[i][j] && this.cells[i][j].type == crushType){\n                            if (this.cells[i][j].status != CELL_STATUS.COMMON) {\n                                newBombModel.push(this.cells[i][j]);\n                            }\n                            this.crushCell(j, i, true, cycleCount);\n                        }\n                    }\n                }\n                this.score += 1000;\n                //this.crushCell(model.x, model.y);\n            }\n        },this);\n        if(bombModels.length > 0){\n            this.curTime += bombTime;\n        }\n        bombModels = newBombModel;\n    }\n}\n/**\n * \n * @param {开始播放的时间} playTime \n * @param {*ll} 位置pos \n * @param {*第几次消除，用于播放音效} step \n */\nGameModel.prototype.addCrushEffect = function(playTime, pos, step){\n    this.effectsQueue.push({\n        playTime,\n        pos,\n        action: \"crush\",\n        step\n    });\n}\n\nGameModel.prototype.addRowBomb = function(playTime, pos){\n    this.effectsQueue.push({\n        playTime,\n        pos,\n        action: \"rowBomb\"\n    });\n}\n\nGameModel.prototype.addColBomb = function(playTime, pos){\n    this.effectsQueue.push({\n        playTime,\n        pos,\n        action: \"colBomb\"\n    });\n}\n\nGameModel.prototype.addWrapBomb = function(playTime, pos){\n    // TODO\n}\n\n// 030 cell\nGameModel.prototype.crushCell = function(x, y, needShake, step){\n    let model = this.cells[y][x];\n    this.pushToChangeModels(model);\n    if(needShake){\n        model.toShake(this.curTime)\n        model.toDie(this.curTime + ANITIME.DIE_SHAKE);\n        this.score += step *30;\n    }\n    else{\n        model.toDie(this.curTime);\n        this.score += step *30;\n    }\n    this.addCrushEffect(this.curTime, cc.v2(model.x, model.y), step);\n    this.cells[y][x] = null; \n}\n\n\nGameModel.prototype.findSelectCell = function(){\n    let res = [];  \n    for(let ii = 0; ii < 3;ii++){\n        res[ii] = [];\n    }\n\n    for (let i = 2; i<= GRID_WIDTH -2;i++ ){\n        for(let j = 2;j <= GRID_HEIGHT -2; j++){\n            if(this.cells[i][j]){\n                //sou1\n                // a     b\n                //   a a\n                // c     d\n                if (this.cells[i][j].type == this.cells[i+1][j].type && this.cells[i-1][j-1] && this.cells[i+1][j-1]\n                    && this.cells[i-1][j+2] && this.cells[i+1][j+2] && this.cells[i][j+1]\n                    ){\n                    // if( ((this.cells[i][j].type == this.cells[i-1][j-1].type ||this.cells[i][j].type == this.cells[i+1][j-1].type)\n                    // && this.cells[i][j-1]) \n                    // || ((this.cells[i][j].type == this.cells[i-1][j+2].type ||this.cells[i][j].type == this.cells[i+1][j+2].type)\n                    // && this.cells[i][j+2])\n                    //  )\n                    //  this.death_sign = false;\n\n                     if(((this.cells[i][j].type == this.cells[i-1][j-1].type)\n                     && this.cells[i][j-1])){\n                         this.death_sign = false;\n                        res[0] = [i,j];\n                        res[1] = [i+1,j];\n                        res[2] = [i-1,j-1];\n                        console.log(this.cells[i][j].type+ \"@@@@@@@@@@@111 \" +this.cells[i-1][j-1].type);\n                        return res;\n                         break;\n                     }\n                     if(((this.cells[i][j].type == this.cells[i-1][j+1].type)\n                     && this.cells[i][j-1])){\n                         this.death_sign = false;\n                        res[0] = [i,j];\n                        res[1] = [i+1,j];\n                        res[2] = [i-1,j+1];\n                        console.log(this.cells[i][j].type+ \"@@@@@@@@@@@222 \"+this.cells[i-1][j+1].type);\n                        return res;\n                         break;\n                     }\n                     if(((this.cells[i][j].type == this.cells[i+2][j+1].type)\n                     && this.cells[i][j+2])){\n                         this.death_sign = false;\n                        res[0] = [i,j];\n                        res[1] = [i+1,j];\n                        res[2] = [i+2,j+1];\n                        console.log(this.cells[i][j].type+ \"@@@@@@@@@@@333 \" + this.cells[i+2][j+1].type);\n                         return res;\n                         break;\n                     }\n                     if(((this.cells[i][j].type == this.cells[i+2][j-1].type)\n                     && this.cells[i][j+2])){\n                         this.death_sign = false;\n                        res[0] = [i,j];\n                        res[1] = [i+1,j];\n                        res[2] = [i+2,j-1];\n                        console.log(this.cells[i][j].type+ \"@@@@@@@@@@@444 \" + this.cells[i+2][j-1].type);\n                         return res;\n                         break;\n                     }\n                }\n                //sou2\n                // a   b\n                //   a\n                //   a \n                // c   d\n                if (this.cells[i][j].type == this.cells[i][j+1].type && this.cells[i-1][j-1] && this.cells[i-1][j+1]\n                    && this.cells[i+2][j-1] && this.cells[i+2][j+1] && this.cells[i+1][j]\n                    ){\n                    if(((this.cells[i][j].type == this.cells[i-1][j-1].type )\n                     && this.cells[i-1][j])){\n                         this.death_sign = false;\n                         res[0] = [i,j];\n                         res[1] = [i,j+1];\n                         res[2] = [i-1,j-1];\n                         console.log(this.cells[i][j].type+ \"@@@@@@@@@@@555 \" +this.cells[i-1][j-1].type);\n                         return res;\n                         break;\n                     }\n                     if(((this.cells[i][j].type == this.cells[i-1][j+2].type)\n                     && this.cells[i-1][j])){\n                         this.death_sign = false;\n                         res[0] = [i,j];\n                         res[1] = [i,j+1];\n                         res[2] = [i-1,j+2];\n                         console.log(this.cells[i][j].type+ \"@@@@@@@@@@@666 \" +this.cells[i-1][j+2].type);\n                         return res;\n                         break;\n                     }\n                     if(((this.cells[i][j].type == this.cells[i+1][j-1].type )\n                     && this.cells[i+2][j])){\n                         this.death_sign = false;\n                         res[0] = [i,j];\n                         res[1] = [i,j+1];\n                         res[2] = [i+1,j-1];\n                         console.log(this.cells[i][j].type+ \"@@@@@@@@@@@777 \" +this.cells[i+1][j-1].type);\n                         return res;\n                         break;\n                     }\n                     if(((this.cells[i][j].type == this.cells[i+1][j+2].type)\n                     && this.cells[i+2][j])){\n                         this.death_sign = false;\n                         res[0] = [i,j];\n                         res[1] = [i,j+1];\n                         res[2] = [i+1,j+2];\n                         console.log(this.cells[i][j].type+ \"@@@@@@@@@@@888 \" +this.cells[i+1][j+2].type);\n                         return res;\n                         break;\n                     }\n                }else{\n                    //sou3\n                    // a   a      a   b\n                    //   a          a\n                    // c          a    \n                    if(this.cells[i][j].type == this.cells[i-1][j-1].type && this.cells[i-1][j+1] && this.cells[i-1][j]\n                        && this.cells[i+1][j-1] && this.cells[i][j-1] && this.cells[i-1][j-1]\n                        ){\n                        if(this.cells[i][j].type == this.cells[i-1][j+1].type && this.cells[i-1][j]){\n                            this.death_sign = false;\n                            res[0] = [i,j];\n                            res[1] = [i-1,j-1];\n                            res[2] = [i-1,j+1];\n                            console.log(this.cells[i][j].type+ \"@@@@@@@@@@@999 \"+this.cells[i-1][j+1].type);\n                            return res;\n                            break;\n                        }\n                        if(this.cells[i][j].type == this.cells[i+1][j-1].type && this.cells[i][j-1]){\n                            this.death_sign = false;\n                            res[0] = [i,j];\n                            res[1] = [i-1,j-1];\n                            res[2] = [i+1,j-1];\n                            console.log(this.cells[i][j].type+ \"@@@@@@@@@@@xxx \"+this.cells[i+1][j-1].type);\n                            return res;\n                            break;\n                        }\n                    }\n                    //sou4\n                    //     a          b\n                    //   a          a\n                    // b   a      a   a\n                    if(this.cells[i][j].type == this.cells[i+1][j+1].type && this.cells[i-1][j+1] && this.cells[i][j+1]\n                        && this.cells[i+1][j-1] && this.cells[i+1][j] && this.cells[i+1][j+1]\n                        ){\n                        if(this.cells[i][j].type == this.cells[i-1][j+1].type && this.cells[i][j+1]){\n                            this.death_sign = false;\n                            res[0] = [i,j];\n                            res[1] = [i+1,j+1];\n                            res[2] = [i-1,j+1];\n                            console.log(this.cells[i][j].type+ \"@@@@@@@@@@@aaa \"+this.cells[i-1][j+1].type);\n                            return res;\n                            break;\n                        }\n                        if(this.cells[i][j].type == this.cells[i+1][j-1].type && this.cells[i+1][j]){\n                            this.death_sign = false;\n                            res[0] = [i,j];\n                            res[1] = [i+1,j+1];\n                            res[2] = [i+1,j-1];\n                            console.log(this.cells[i][j].type+ \"@@@@@@@@@@@bbb \"+this.cells[i+1][j-1].type);\n                            return res;\n                            break;\n                        }\n                    }\n\n\n                }\n\n            }\n        } \n    }\n    \n\n\n\n}\n"]}